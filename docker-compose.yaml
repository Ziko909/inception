# Ziko909

# docker compose file for running the application

name: inception

services:
# nginx service
 nginx:
  image: nginx:v1
  build:
   context: ./srcs/requirements/nginx
  env_file: ./.env
  container_name:  nginx
  networks:
   - inception
  ports:
   - "443:443"
  restart: on-failure
  volumes:
   - wordpress-volume:/var/www/html
  depends_on:
    - wordpress
    - adminer

# wordpress service
 wordpress:
   image: wordpress:v1
   build:
     context: ./srcs/requirements/wordpress
   env_file: ./.env
   container_name: wordpress
   networks:
     - inception
   restart: on-failure
   volumes:
     - wordpress-volume:/var/www/html
   depends_on:
     - mariadb

# mariadb service
 mariadb:
  image: mariadb:v1
  build:
   context: ./srcs/requirements/mariadb
   args:
     MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
     DB_NAME: ${DB_NAME}
     MYSQL_USER: ${MYSQL_USER}
     MYSQL_PASSWORD: ${MYSQL_PASSWORD}
  env_file: ./.env
  container_name: mariadb
  networks:
   - inception
  restart: on-failure
  volumes:
   - mariadb-volume:/var/lib/mysql

# adminer
 adminer:
  image: adminer:v1
  build:
    context: ./srcs/requirements/adminer
  env_file: ./.env
  container_name: adminer
  networks:
    - inception
  restart: on-failure
  depends_on:
    - mariadb
  volumes:
    - wordpress-volume:/var/www/html

# static web-site
 static-site:
  image: static-site:v1
  build:
   context: ./srcs/requirements/static-site
  env_file: ./.env
  container_name: static-site
  networks:
   - inception
  ports:
   - "80:80"
  restart: on-failure

# volumes of the services
volumes:
 wordpress-volume:
  driver_opts:
   type: ""
   o: bind
   device: /home/zaabou/data/wordpress
 mariadb-volume:
   driver_opts:
     type: ""
     o: bind
     device: /home/zaabou/data/mariadb

# network of project
networks:
 inception:
  name: inception
  attachable: false
